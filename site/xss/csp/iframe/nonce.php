<?php
$nonce = base64_encode(random_bytes(18));
header("Content-Security-Policy: script-src 'nonce-{$nonce}'")
?>
<body>
<script nonce="<?= $nonce; ?>">
	var ifrm = document.createElement('iframe');
	document.body.appendChild(ifrm);

	var i = new Image();
	i.src = 'https://example.com/blocked-by-csp.jpg';
	ifrm.appendChild(i);

	var s = document.createElement('script');
	s.text = "alert('hello from the iframe');";
	s.nonce = '<?= $nonce; ?>';
	document.head.appendChild(s);

	var s = document.createElement('script');
	s.text = "alert('nope, no nonce');";
	document.head.appendChild(s);
</script>
</body>